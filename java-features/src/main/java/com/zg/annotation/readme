please refer to bit-statemachine